<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/layout/index :: dynamic(~{::main})}">
    <body>
        <main>
            <style>
                .page-title { font-weight: 800; color: #333; margin-bottom: 30px; border-left: 5px solid #0d6efd; padding-left: 15px; }
                
                /* Thẻ đơn hàng */
                .order-card {
                    background: white; border-radius: 12px;
                    border: 1px solid #eef0f3; margin-bottom: 20px;
                    transition: all 0.3s ease; overflow: hidden;
                }
                .order-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.08); border-color: #dbe2ea; }
                
                .order-header {
                    background: #f8f9fa; padding: 15px 20px;
                    display: flex; justify-content: space-between; align-items: center;
                    border-bottom: 1px solid #eef0f3;
                }
                .order-body { padding: 20px; }
                .order-footer {
                    padding: 15px 20px; border-top: 1px solid #eef0f3;
                    display: flex; justify-content: flex-end; align-items: center; gap: 15px;
                    background: #fff;
                }
                
                /* Trạng thái */
                .status-badge {
                    padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600;
                    display: flex; align-items: center; gap: 5px;
                }
                .status-0 { background: #fff3cd; color: #856404; } /* Chờ duyệt */
                .status-1 { background: #cce5ff; color: #004085; } /* Đang giao */
                .status-2 { background: #d4edda; color: #155724; } /* Đã giao */
                .status-3 { background: #f8d7da; color: #721c24; } /* Đã hủy */
                
                .btn-detail {
                    border: 1px solid #0d6efd; color: #0d6efd; background: white;
                    padding: 8px 20px; border-radius: 6px; font-weight: 600; text-decoration: none;
                    transition: all 0.2s;
                }
                .btn-detail:hover { background: #0d6efd; color: white; }
            </style>
            
            <div class="container py-5 animate__animated animate__fadeIn">
                <h3 class="page-title">LỊCH SỬ ĐƠN HÀNG</h3>
                
                <div th:if="${orders.empty}" class="text-center py-5 bg-white rounded-4 shadow-sm">
                    <img src="https://cdn-icons-png.flaticon.com/512/4076/4076432.png" width="120" class="mb-4 opacity-50">
                    <h5 class="fw-bold text-muted">Chưa có đơn hàng nào</h5>
                    <p class="text-secondary mb-4">Bạn chưa mua sắm gì cả. Hãy khám phá các sản phẩm ngay!</p>
                    <a href="/home/index" class="btn btn-primary rounded-pill px-5 fw-bold shadow-sm">
                        <i class="bi bi-cart-plus me-2"></i> Mua sắm ngay
                    </a>
                </div>
                
                <div th:if="${!orders.empty}">
                    <div th:each="o : ${orders}" class="order-card">
                        
                        <div class="order-header">
                            <div>
                                <span class="fw-bold text-dark me-2"><i class="bi bi-box-seam me-1"></i>Đơn hàng #[[${o.id}]]</span>
                                <small class="text-muted border-start ps-2 ms-2">
                                    <i class="bi bi-calendar3 me-1"></i> [[${#dates.format(o.createDate, 'dd/MM/yyyy HH:mm')}]]
                                </small>
                            </div>
                            
                            <div>
                                <span th:if="${o.status == 0}" class="status-badge status-0"><i class="bi bi-hourglass-split"></i> Chờ xác nhận</span>
                                <span th:if="${o.status == 1}" class="status-badge status-1"><i class="bi bi-truck"></i> Đang giao hàng</span>
                                <span th:if="${o.status == 2}" class="status-badge status-2"><i class="bi bi-check-circle-fill"></i> Giao thành công</span>
                                <span th:if="${o.status == 3}" class="status-badge status-3"><i class="bi bi-x-circle-fill"></i> Đã hủy</span>
                            </div>
                        </div>
                        
                        <div class="order-body">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="d-flex align-items-center mb-2">
                                        <i class="bi bi-geo-alt-fill text-danger me-2"></i>
                                        <span class="text-secondary small fw-bold text-uppercase">Địa chỉ nhận hàng</span>
                                    </div>
                                    <p class="mb-0 text-dark fw-bold ps-4">[[${o.address}]]</p>
                                </div>
                                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                                    <small class="text-secondary d-block">Tổng tiền thanh toán</small>
                                    <span class="fs-4 fw-bold text-danger">
                                        [[${#numbers.formatDecimal(o.totalAmount != null ? o.totalAmount : 0, 0, 'COMMA', 0, 'POINT')}]] ₫
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="order-footer">
                            <span class="text-muted small me-auto d-none d-md-inline">Cảm ơn bạn đã mua sắm tại Tech Store! ❤️</span>
                            <a th:href="@{|/order/detail/${o.id}|}" class="btn-detail">
                                Xem chi tiết
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </body>
</html>